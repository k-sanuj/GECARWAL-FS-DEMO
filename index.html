<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fee Structure Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Times+New+Roman&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Times New Roman', serif; background:#f5f5f5; padding:20px; }
    .container { max-width:900px; margin:auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 4px 20px rgba(0,0,0,0.1);}
    h2 { text-align:center; margin-bottom:20px; }
    form { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
    label { font-size:14px; margin-bottom:4px; display:block; }
    input { width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; }
    .full { grid-column:1/-1; }
    button { padding:10px 16px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    .btn-primary { background:#007bff; color:#fff; }
    .btn-ghost { background:#eee; }
    #preview { display:none; margin-top:20px; border:1px solid #ddd; background:white; position:relative; }
    #preview { width:210mm; min-height:297mm; margin:auto; padding:20px; box-sizing:border-box; }
    table { width:100%; border-collapse:collapse; margin-top:10px;}
    td,th { border:1px solid #000; padding:6px; text-align:left; }
    .header { text-align:center; font-weight:bold; font-size:20px; margin-bottom:5px; color:#0046ad; }
    .subheader { text-align:center; font-size:14px; margin-bottom:15px; }
    .watermark {
      position:absolute; top:40%; left:50%; transform:translate(-50%,-50%);
      opacity:0.05; z-index:0;
    }
    .footer { margin-top:30px; display:flex; justify-content:space-between; font-size:14px; }
    .college-logo { width:80px; position:absolute; top:10px; left:10px; }
    .ref-section { display:flex; justify-content:space-between; font-size:12px; margin-bottom:20px; }
    @media(max-width:600px) {
      form { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Fee Structure Form</h2>
    <form id="feeForm">
      <div><label>Institute</label><input type="text" name="institute" value="Government Engineering College, Arwal" required></div>
      <div><label>Student Name</label><input type="text" name="studentName" required></div>
      <div><label>Father's Name</label><input type="text" name="fatherName" required></div>
      <div><label>Registration Number</label><input type="text" name="regNo" required></div>
      <div><label>Branch</label><input type="text" name="branch" required></div>
      <div><label>Category</label><input type="text" name="category" required></div>
      <div><label>Semester</label><input type="text" name="semester" required></div>
      <div><label>Session</label><input type="text" name="session" required></div>
      <div><label>Academic Year</label><input type="text" name="academicYear" required></div>

      <div class="full"><label>Admission Fee</label><input type="number" name="admissionFee" value="10"></div>
      <div><label>Tuition Fee</label><input type="number" name="tuitionFee" value="120"></div>
      <div><label>Registration Fee</label><input type="number" name="registrationFee" value="2100"></div>
      <div><label>Examination Fee</label><input type="number" name="examFee" value="7400"></div>
      <div><label>Development Fee</label><input type="number" name="developmentFee" value="2500"></div>
      <div><label>Library Fee</label><input type="number" name="libraryFee" value="0"></div>
      <div><label>Hostel Fee</label><input type="number" name="hostelFee" value="14400"></div>
      <div><label>Mess Fee</label><input type="number" name="messFee" value="33600"></div>
      <div><label>Insurance Fee</label><input type="number" name="insuranceFee" value="500"></div>
      <div><label>Other Fee</label><input type="number" name="otherFee" value="0"></div>

      <div class="full" style="text-align:right; margin-top:10px;">
        <button type="reset" class="btn-ghost">Reset</button>
        <button type="submit" class="btn-primary">Generate Fee Structure</button>
      </div>
    </form>

    <!-- Preview -->
    <div id="preview">
      <img src="download.jpeg" class="college-logo" alt="logo">
      <img src="download.jpeg" class="watermark" width="400" alt="watermark">

      <!-- Reference & Date -->
      <div class="ref-section">
        <div>Ref. No.: GEC/F/430/2025</div>
        <div>Date: <span id="p_date"></span></div>
      </div>

      <div class="header">Government Engineering College, Arwal</div>
      <div class="subheader">Shivpur, Mehandia, Arwal â€“ 804409<br>
        Email: <span style="color:blue; text-decoration:underline;">registrar.gecarwal@gmail.com</span>
      </div>

      <h3 style="text-align:center; margin:20px 0;">Fee Structure</h3>

      <p><b>Name of the Student:</b> <span id="p_student"></span></p>
      <p><b>Father's Name:</b> <span id="p_father"></span></p>
      <p><b>Registration No:</b> <span id="p_regNo"></span></p>
      <p><b>Branch:</b> <span id="p_branch"></span></p>
      <p><b>Category:</b> <span id="p_category"></span></p>
      <p><b>Semester:</b> <span id="p_semester"></span></p>
      <p><b>Session:</b> <span id="p_session"></span></p>
      <p><b>Academic Year:</b> <span id="p_academicYear"></span></p>

      <h3>Details of Fees</h3>
      <table>
        <tbody>
          <tr><td>Admission Fee</td><td id="p_admissionFee"></td></tr>
          <tr><td>Tuition Fee</td><td id="p_tuitionFee"></td></tr>
          <tr><td>Registration Fee</td><td id="p_registrationFee"></td></tr>
          <tr><td>Examination Fee</td><td id="p_examFee"></td></tr>
          <tr><td>Development Fee</td><td id="p_developmentFee"></td></tr>
          <tr><td>Library Fee</td><td id="p_libraryFee"></td></tr>
          <tr><td>Hostel Fee</td><td id="p_hostelFee"></td></tr>
          <tr><td>Mess Fee</td><td id="p_messFee"></td></tr>
          <tr><td>Insurance Fee</td><td id="p_insuranceFee"></td></tr>
          <tr><td>Other Fee</td><td id="p_otherFee"></td></tr>
          <tr><td><b>Total</b></td><td id="p_total"></td></tr>
        </tbody>
      </table>

      <div class="footer">
        <div>Place: Arwal<br>Date: <span id="p_date2"></span></div>
        <div>Registrar<br>Government Engineering College, Arwal</div>
      </div>

      <div style="text-align:right; margin-top:20px;">
        <button id="downloadBtn" class="btn-primary">Download PDF</button>
      </div>
    </div>
  </div>

  <!-- jsPDF & html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const form = document.getElementById("feeForm");
    const preview = document.getElementById("preview");

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());

      // Fill preview
      document.getElementById("p_student").textContent = data.studentName;
      document.getElementById("p_father").textContent = data.fatherName;
      document.getElementById("p_regNo").textContent = data.regNo;
      document.getElementById("p_branch").textContent = data.branch;
      document.getElementById("p_category").textContent = data.category;
      document.getElementById("p_semester").textContent = data.semester;
      document.getElementById("p_session").textContent = data.session;
      document.getElementById("p_academicYear").textContent = data.academicYear;

      // Fees
      let total = 0;
      ["admissionFee","tuitionFee","registrationFee","examFee","developmentFee","libraryFee","hostelFee","messFee","insuranceFee","otherFee"].forEach(f=>{
        const val = Number(data[f]||0);
        document.getElementById("p_"+f).textContent = val;
        total += val;
      });
      document.getElementById("p_total").textContent = total;

      // Dates
      const today = new Date().toLocaleDateString();
      document.getElementById("p_date").textContent = today;
      document.getElementById("p_date2").textContent = today;

      preview.style.display = "block";
    });

    document.getElementById("downloadBtn").addEventListener("click", () => {
      html2canvas(preview, { scale: 2 }).then(canvas => {
        const imgData = canvas.toDataURL("image/png");
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF("p","mm","a4");
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();
        pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
        pdf.save("Fee_Structure.pdf");
      });
    });
  </script>
</body>
</html>
